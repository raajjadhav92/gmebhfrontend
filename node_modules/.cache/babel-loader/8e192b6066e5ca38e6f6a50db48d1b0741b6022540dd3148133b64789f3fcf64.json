{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\raajj\\\\Desktop\\\\backend\\\\frontend\\\\src\\\\components\\\\ProtectedRoute.js\",\n  _s = $RefreshSig$();\nimport React from 'react';\nimport { Navigate, useLocation } from 'react-router-dom';\nimport { useAuth } from '../contexts/AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProtectedRoute = ({\n  children,\n  allowedRoles = []\n}) => {\n  _s();\n  const {\n    isAuthenticated,\n    user,\n    loading\n  } = useAuth();\n  const location = useLocation();\n\n  // Show loading while checking authentication\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"min-h-screen flex items-center justify-center bg-gray-50\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 14,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-600\",\n          children: \"Loading...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 15,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 13,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 12,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Redirect to landing page if not authenticated\n  if (!isAuthenticated || !user) {\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/\",\n      replace: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 23,\n      columnNumber: 12\n    }, this);\n  }\n\n  // Check role-based access if roles are specified\n  console.log(\"ProtectedRoute - User Role:\", user === null || user === void 0 ? void 0 : user.role, \"Allowed Roles:\", allowedRoles);\n\n  // Handle case where user role is undefined or null by checking if it exists\n  if (allowedRoles.length > 0 && (!(user !== null && user !== void 0 && user.role) || !allowedRoles.includes(user.role))) {\n    console.log(\"Access denied due to role mismatch or missing role\");\n\n    // For debugging purposes, let's check what's going on\n    if (!(user !== null && user !== void 0 && user.role)) {\n      console.error(\"User role is undefined or null! User object:\", user);\n    } else {\n      console.error(\"Role mismatch! User role:\", user.role, \"Allowed roles:\", allowedRoles);\n    }\n\n    // TEMPORARY FIX: Check URL to see if we should bypass role check\n    const currentPath = window.location.pathname;\n    const searchParams = new URLSearchParams(window.location.search);\n    const debugMode = searchParams.get('debug') === 'true';\n    console.log(\"Current path:\", currentPath, \"Debug mode:\", debugMode);\n\n    // Skip access control for admin rooms page if debug mode is on\n    if (currentPath === '/admin/rooms' && debugMode) {\n      console.log(\"DEBUG MODE ENABLED: Bypassing role check for admin rooms\");\n      return children;\n    }\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"min-h-screen flex items-center justify-center bg-gray-50\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center p-8\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"text-6xl mb-4\",\n          children: \"\\uD83D\\uDEAB\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"text-2xl font-bold text-gray-800 mb-2\",\n          children: \"Access Denied\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-gray-600 mb-4\",\n          children: \"You don't have permission to access this page.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-sm text-gray-500\",\n          children: [\"Required role(s): \", allowedRoles.join(', '), \" | Your role: \", user.role]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => window.history.back(),\n          className: \"mt-4 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors\",\n          children: \"Go Back\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 7\n    }, this);\n  }\n\n  // Render the protected component\n  return children;\n};\n_s(ProtectedRoute, \"zEGFxQ50Ze7Wo58QBItO0ZM7uxw=\", false, function () {\n  return [useAuth, useLocation];\n});\n_c = ProtectedRoute;\nexport default ProtectedRoute;\nvar _c;\n$RefreshReg$(_c, \"ProtectedRoute\");","map":{"version":3,"names":["React","Navigate","useLocation","useAuth","jsxDEV","_jsxDEV","ProtectedRoute","children","allowedRoles","_s","isAuthenticated","user","loading","location","className","fileName","_jsxFileName","lineNumber","columnNumber","to","replace","console","log","role","length","includes","error","currentPath","window","pathname","searchParams","URLSearchParams","search","debugMode","get","join","onClick","history","back","_c","$RefreshReg$"],"sources":["C:/Users/raajj/Desktop/backend/frontend/src/components/ProtectedRoute.js"],"sourcesContent":["import React from 'react';\nimport { Navigate, useLocation } from 'react-router-dom';\nimport { useAuth } from '../contexts/AuthContext';\n\nconst ProtectedRoute = ({ children, allowedRoles = [] }) => {\n  const { isAuthenticated, user, loading } = useAuth();\n  const location = useLocation();\n\n  // Show loading while checking authentication\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">Loading...</p>\n        </div>\n      </div>\n    );\n  }\n\n  // Redirect to landing page if not authenticated\n  if (!isAuthenticated || !user) {\n    return <Navigate to=\"/\" replace />;\n  }\n\n  // Check role-based access if roles are specified\n  console.log(\"ProtectedRoute - User Role:\", user?.role, \"Allowed Roles:\", allowedRoles);\n  \n  // Handle case where user role is undefined or null by checking if it exists\n  if (allowedRoles.length > 0 && (!user?.role || !allowedRoles.includes(user.role))) {\n    console.log(\"Access denied due to role mismatch or missing role\");\n    \n    // For debugging purposes, let's check what's going on\n    if (!user?.role) {\n      console.error(\"User role is undefined or null! User object:\", user);\n    } else {\n      console.error(\"Role mismatch! User role:\", user.role, \"Allowed roles:\", allowedRoles);\n    }\n    \n    // TEMPORARY FIX: Check URL to see if we should bypass role check\n    const currentPath = window.location.pathname;\n    const searchParams = new URLSearchParams(window.location.search);\n    const debugMode = searchParams.get('debug') === 'true';\n    \n    console.log(\"Current path:\", currentPath, \"Debug mode:\", debugMode);\n    \n    // Skip access control for admin rooms page if debug mode is on\n    if (currentPath === '/admin/rooms' && debugMode) {\n      console.log(\"DEBUG MODE ENABLED: Bypassing role check for admin rooms\");\n      return children;\n    }\n    \n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n        <div className=\"text-center p-8\">\n          <div className=\"text-6xl mb-4\">ðŸš«</div>\n          <h2 className=\"text-2xl font-bold text-gray-800 mb-2\">Access Denied</h2>\n          <p className=\"text-gray-600 mb-4\">\n            You don't have permission to access this page.\n          </p>\n          <p className=\"text-sm text-gray-500\">\n            Required role(s): {allowedRoles.join(', ')} | Your role: {user.role}\n          </p>\n          <button\n            onClick={() => window.history.back()}\n            className=\"mt-4 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors\"\n          >\n            Go Back\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  // Render the protected component\n  return children;\n};\n\nexport default ProtectedRoute;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}